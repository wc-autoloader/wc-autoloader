const e="@components/";function t(){const e={imports:{}};return document.querySelectorAll('script[type="importmap"]').forEach(t=>{try{const n=JSON.parse(t.innerHTML);n.imports&&(e.imports=Object.assign(e.imports,n.imports))}catch(e){throw new Error("Failed to parse importmap JSON: "+e)}}),Object.keys(e.imports).length>0?e:null}function n(t){if(t.startsWith(e)){if(t.endsWith("/")){const e=t.slice(12,t.length-1),[n,o]=e.split("|",2);if(""===n)throw new Error("Invalid importmap key: "+t);return{key:t,prefix:n.replaceAll("/","-").toLowerCase(),loaderKey:o??null,isNameSpaced:!0}}{const e=t.slice(12),[n,o]=e.split("|",2),[r,l]=(o??"").split(",",2);if(""===n)throw new Error("Invalid importmap key: "+t);return{key:t,tagName:n.replaceAll("/","-").toLowerCase(),loaderKey:r||null,extends:l||null,isNameSpaced:!1}}}return null}function o(e){const t={},o={};for(const[r,l]of Object.entries(e.imports)){const e=n(r);null!==e&&(e.isNameSpaced?t[e.prefix]=e:o[e.tagName]=e)}return{prefixMap:t,loadMap:o}}async function r(e){return(await import(e)).default}const l="*",a="vanilla",i={postfix:".js",loader:r},s={scanImportmap:!0,loaders:{[a]:i,[l]:a},observable:!0},m=new Set,c=new Set,d=new Map;if("undefined"!=typeof window){[[HTMLButtonElement,"button"],[HTMLInputElement,"input"],[HTMLAnchorElement,"a"],[HTMLImageElement,"img"],[HTMLDivElement,"div"],[HTMLSpanElement,"span"],[HTMLParagraphElement,"p"],[HTMLUListElement,"ul"],[HTMLOListElement,"ol"],[HTMLLIElement,"li"],[HTMLTableElement,"table"],[HTMLFormElement,"form"],[HTMLLabelElement,"label"],[HTMLSelectElement,"select"],[HTMLTextAreaElement,"textarea"],[HTMLHeadingElement,"h1"],[HTMLQuoteElement,"blockquote"],[HTMLPreElement,"pre"],[HTMLBRElement,"br"],[HTMLHRElement,"hr"],[HTMLModElement,"ins"],[HTMLTableCaptionElement,"caption"],[HTMLTableColElement,"col"],[HTMLTableSectionElement,"tbody"],[HTMLTableRowElement,"tr"],[HTMLTableCellElement,"td"],[HTMLFieldSetElement,"fieldset"],[HTMLLegendElement,"legend"],[HTMLDListElement,"dl"],[HTMLOptGroupElement,"optgroup"],[HTMLOptionElement,"option"],[HTMLStyleElement,"style"],[HTMLScriptElement,"script"],[HTMLTemplateElement,"template"],[HTMLCanvasElement,"canvas"],[HTMLIFrameElement,"iframe"],[HTMLObjectElement,"object"],[HTMLEmbedElement,"embed"],[HTMLVideoElement,"video"],[HTMLAudioElement,"audio"],[HTMLTrackElement,"track"],[HTMLMapElement,"map"],[HTMLAreaElement,"area"],[HTMLSourceElement,"source"],[HTMLParamElement,"param"],[HTMLMeterElement,"meter"],[HTMLProgressElement,"progress"],[HTMLOutputElement,"output"],[HTMLDetailsElement,"details"],[HTMLDialogElement,"dialog"],[HTMLMenuElement,"menu"],[HTMLSlotElement,"slot"],[HTMLTimeElement,"time"],[HTMLDataElement,"data"],[HTMLPictureElement,"picture"]].forEach(([e,t])=>{void 0!==e&&d.set(e,t)})}function u(e){const t=e.tagName.toLowerCase();let n,o;if(t.includes("-"))n=t,o=null;else{const r=e.getAttribute("is");if(null===r)throw new Error("Custom element without a dash or 'is' attribute found: "+t);if(!r.includes("-"))throw new Error("Custom element 'is' attribute without a dash found: "+t);n=r,o=t}return{name:n,extends:o}}function p(e,t){for(const[n,o]of Object.entries(t))if(e.startsWith(n+"-"))return o;return null}function f(e){const t=new Array,n=new Set;for(const o of e){const e=o.tagName;if(n.has(e))continue;n.add(e);const r=u(o);m.has(r.name)||(c.has(r.name)||t.push(r))}return t}function E(e,t,n){let o;if(null===t||t===l||""===t){let t=null;const r=[];for(const[e,t]of Object.entries(n)){if(e===l)continue;const o="string"==typeof t?n[t]:t;"string"!=typeof o&&r.push(o)}r.sort((e,t)=>t.postfix.length-e.postfix.length);for(const n of r)if(e.endsWith(n.postfix)){t=n;break}t?o=t:(o=n[l],"string"==typeof o&&(o=n[o]))}else o=n[t];if("string"==typeof o)throw new Error("Loader redirection is not supported here");return o}function L(e){for(const[t,n]of d)if(e.prototype instanceof t)return n;return null}async function M(e,t,n){let o=e.querySelectorAll(":not(:defined)"),r=f(Array.from(o));for(;r.length>0;){for(const e of r){const o=p(e.name,t);if(null===o)throw new Error("No matching namespace found for lazy loaded component: "+e.name);let r;try{r=E("",o.loaderKey,n)}catch(t){throw new Error("Loader redirection is not supported for lazy loaded components: "+e.name)}c.add(e.name);const l=e.name.slice(o.prefix.length+1);if(""===l)throw new Error("Invalid component name for lazy loaded component: "+e.name);const a=o.key+l+r.postfix;try{const t=await r.loader(a);if(null===t)throw new Error("Loader returned null for component: "+e.name);null===e.extends?customElements.define(e.name,t):customElements.define(e.name,t,{extends:e.extends})}catch(t){console.error(`Failed to lazy load component '${e.name}':`,t),m.add(e.name)}finally{c.delete(e.name)}}o=e.querySelectorAll(":not(:defined)"),r=f(Array.from(o))}}async function T(e,t){for(const[n,o]of Object.entries(e)){let e;try{e=E(o.key,o.loaderKey,t)}catch(e){throw new Error("Loader redirection is not supported for eager loaded components: "+n)}try{const t=await e.loader(o.key);if(null!==t){let e=o.extends;null===e&&(e=L(t)),null===e?customElements.define(n,t):customElements.define(n,t,{extends:e})}}catch(e){m.has(n)||(console.error(`Failed to eager load component '${n}':`,e),m.add(n))}}}async function H(){const e=t();if(null===e)return;const{prefixMap:n,loadMap:r}=o(e);document.addEventListener("DOMContentLoaded",async()=>{if(0===Object.keys(n).length)return;try{await M(document,n,s.loaders)}catch(e){throw new Error("Failed to lazy load components: "+e)}if(!s.observable)return;new MutationObserver(async()=>{try{await M(document,n,s.loaders)}catch(e){throw new Error("Failed to lazy load components: "+e)}}).observe(document.documentElement,{childList:!0,subtree:!0})});try{await T(r,s.loaders)}catch(e){throw new Error("Failed to eager load components: "+e)}}export{l as DEFAULT_KEY,a as VANILLA_KEY,i as VANILLA_LOADER,o as buildMap,s as config,T as eagerLoad,M as lazyLoad,r as load,t as loadImportmap,H as registerHandler};
//# sourceMappingURL=index.esm.min.js.map
